<!DOCTYPE html>
<html lang="en">

  <head>
      <link rel="stylesheet" type="text/css" href="https://www.sglavoie.com/theme/css/style.css">
      <link rel="stylesheet" type="text/css" href="https://www.sglavoie.com/theme/css/pygments.css">
      <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=PT+Sans|PT+Serif|PT+Mono">

      <meta charset="utf-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="author" content="Sébastien Lavoie">
      <meta name="description" content="Posts and writings by Sébastien Lavoie">

      <link href="https://www.sglavoie.com/feeds/sglavoie.rss.xml" type="application/rss+xml" rel="alternate" title="sglavoie.com RSS" />

      <!-- Favicon -->
      <link rel="apple-touch-icon" sizes="180x180" href="/theme/favicon/apple-touch-icon.png">
      <link rel="icon" type="image/png" sizes="32x32" href="/theme/favicon/favicon-32x32.png">
      <link rel="icon" type="image/png" sizes="16x16" href="/theme/favicon/favicon-16x16.png">
      <link rel="manifest" href="/theme/favicon/site.webmanifest">
      <link rel="mask-icon" href="/theme/favicon/safari-pinned-tab.svg" color="#5bbad5">
      <link rel="shortcut icon" href="/theme/favicon/favicon.ico">
      <meta name="msapplication-TileColor" content="#2d89ef">
      <meta name="msapplication-TileImage" content="/theme/favicon/mstile-144x144.png">
      <meta name="msapplication-config" content="/theme/favicon/browserconfig.xml">
      <meta name="theme-color" content="#000000">
      <meta name="msapplication-config" content="/theme/favicon/browserconfig.xml">
      <meta name="theme-color" content="#000000">

      <meta name="keywords" content="neovim, plugin, productivity, terminal, vim">

      <!-- Open graph for social networks -->
      <meta name="og:title" property="og:title" content="Meet Black, a superb Python code formatter that will automatically reformat your code in accordance to PEP-8 standards.">

      <title>
        sglavoie.com
&ndash; Black: A Python Formatter to Brighten Your&nbsp;Workflow      </title>

<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-150998392-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
  </head>

  <body>
    <aside>
      <div id="user_meta">
        <a href="https://www.sglavoie.com">
          <img src="https://www.sglavoie.com/theme/images/logo.png" alt="logo">
        </a>
        <h2><a href="https://www.sglavoie.com">sglavoie.com</a></h2>
        <p></p>
        <ul>
          <li><a href="https://www.sglavoie.com/category/automation.html">automation</a></li>
          <li><a href="https://www.sglavoie.com/category/tips-and-tricks.html">tips-and-tricks</a></li>
          <li><a href="https://www.sglavoie.com/category/tools.html">tools</a></li>
          <li><a href="https://www.sglavoie.com/category/workflow.html">workflow</a></li>
        </ul>
      </div>
    </aside>

    <main>
      <header>
        <p>
        <a href="https://www.sglavoie.com">Index</a> &brvbar; <a href="https://www.sglavoie.com/archives.html">Archives</a>
        &brvbar; <a href="https://www.sglavoie.com/tags.html">Tags</a>
        &brvbar; <a href="https://www.sglavoie.com/learning-progress-2019.html">Learning Progress</a>
        &brvbar; <a href="https://www.sglavoie.com/feeds/sglavoie.rss.xml">RSS</a>
        </p>
      </header>

<article>
  <div class="article_title">
    <h1><a href="https://www.sglavoie.com/posts/2019/07/13/black-a-python-formatter-to-brighten-your-workflow/">Black: A Python Formatter to Brighten Your&nbsp;Workflow</a></h1>
  </div>
  <div class="article_readtime">
    <p>Estimated read time: 4 minutes</p>
  </div>
  <div class="article_text">
    <h2>What is&nbsp;Black?</h2>
<p>From its <a href="https://github.com/python/black">GitHub repository</a>:</p>
<blockquote>
<p>Black is the uncompromising Python code formatter. By using it, you agree to cede control over minutiae of hand-formatting. In return, Black gives you speed, determinism, and freedom from pycodestyle nagging about formatting. You will save time and mental energy for more important&nbsp;matters.</p>
</blockquote>
<p><strong>Black</strong> will take less than ideal code and will automatically reformat it according to the <a href="https://www.python.org/dev/peps/pep-0008/"><span class="caps">PEP</span>-8 style guide</a>. It will take care of many things, including the following (taken in that order from <code>README.md</code> in <strong>Black</strong>&#8216;s&nbsp;repo):</p>
<ul>
<li>Wrapping lines properly by shortening as much as possible single&nbsp;statements;</li>
<li>Break long&nbsp;lines;</li>
<li>Remove superfluous empty&nbsp;lines;</li>
<li>Take care of adding trailing commas where&nbsp;necessary;</li>
<li>Convert single quotes (<code>'</code>) to double quotes (<code>"</code>);</li>
<li>Convert numeric literals to lowercase (<code>0XAB</code> to <code>0xAB</code>);</li>
<li>Superfluous parentheses are&nbsp;removed;</li>
<li>Split call chains on different&nbsp;lines;</li>
<li>Works from the terminal and support many code editor integrations (Emacs, Vim, <span class="caps">VS</span> Code, Sublime,&nbsp;etc.).</li>
</ul>
<p>Now that it&#8217;s clear <em>why</em> it can be a good idea to use it, let&#8217;s see how it works with Vim and the&nbsp;terminal.</p>
<hr>
<h2>How to use&nbsp;it?</h2>
<p>First, we need to install it using Python&nbsp;3.6.0+:</p>
<div class="highlight"><pre><span></span>$ pip install black
</pre></div>


<p>That&#8217;s&nbsp;it!</p>
<h3>Use it from the&nbsp;terminal</h3>
<p>In its simplest invocation, we can use <strong>Black</strong> by specifying a file or a directory by&nbsp;typing:</p>
<div class="highlight"><pre><span></span>$ black path_to_file_or_directory
</pre></div>


<p>It doesn&#8217;t come with many options as its goal is to automatically format code consistently, but you can find out more about this tool in the following&nbsp;way:</p>
<div class="highlight"><pre><span></span>$ black --help
</pre></div>


<h3>Use it with&nbsp;Vim</h3>
<p>Using <strong>Black</strong> as part of your workflow in a code editor is where I believe it really shines, because you can see almost in real-time when you make a formatting mistake, which will help down the road in committing less&nbsp;sins.</p>
<p>Integrating <strong>Black</strong> with Vim or Neovim is quick and painless, adding a simple line in your <code>.vimrc</code> or <code>init.vim</code> file. You can also proceed to do a manual installation without a plugin manager as explained in the GitHub&nbsp;repository.</p>
<p>With <a href="https://github.com/junegunn/vim-plug">vim-plug</a>:</p>
<div class="highlight"><pre><span></span>Plug <span class="s1">&#39;python/black&#39;</span>
</pre></div>


<p>With <a href="https://github.com/VundleVim/Vundle.vim">Vundle</a>:</p>
<div class="highlight"><pre><span></span>Plugin <span class="s1">&#39;python/black&#39;</span>
</pre></div>


<p>Once the plugin is installed, it may well be convenient to automatically format Python files when saving the buffer, which can be accomplished by adding the following line to the configuration&nbsp;file:</p>
<div class="highlight"><pre><span></span>autocmd <span class="nb">BufWritePre</span> *.<span class="k">py</span> execute <span class="s1">&#39;:Black&#39;</span>
</pre></div>


<p>By default, <strong>Black</strong> works surprisingly well on its own. I only went ahead and changed the default line length from 88 to 79 characters by also adding this&nbsp;line:</p>
<div class="highlight"><pre><span></span><span class="k">let</span> <span class="k">g</span>:black_linelength <span class="p">=</span> <span class="m">79</span>  <span class="c">&quot; default is 88</span>
</pre></div>


<p>Finally, it&#8217;s worth noting you can update <strong>Black</strong> at any point from the terminal with <code>pip</code> and you can also do it directly from within Vim/Neovim with this&nbsp;command:</p>
<div class="highlight"><pre><span></span><span class="p">:</span>BlackUpgrade
</pre></div>


<p>Vim will then output something along those&nbsp;lines:</p>
<blockquote>
<p>Upgrading Black with&nbsp;pip&#8230;</p>
<p><span class="caps">DONE</span>! You are all set, thanks for&nbsp;waiting</p>
</blockquote>
<h2>Any&nbsp;example?</h2>
<p>Taking a random Python 3.6+ code sample, we could originally have something like this (hopefully&nbsp;not):</p>
<div class="highlight"><pre><span></span>    <span class="k">for</span> <span class="n">source</span> <span class="ow">in</span>  <span class="n">data_sources</span> <span class="p">:</span>


        <span class="c1"># Retrieve a list of all matching log files in `source`</span>
        <span class="n">log_files</span><span class="o">=</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span> <span class="n">f</span><span class="s1">&#39;{source}/{LOG_NAME}*&#39;</span> <span class="p">)</span>
        <span class="k">if</span> <span class="n">log_files</span>  <span class="o">==</span>  <span class="p">[</span> <span class="p">]:</span>
                <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">There is no log file to delete in {source}.&#39;</span><span class="p">)</span>
                <span class="k">continue</span>
        <span class="k">else</span>    <span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Log files in {source}:&#39;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">log_file</span> <span class="ow">in</span> <span class="n">log_files</span><span class="p">:</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">ARGUMENTS</span><span class="o">.</span><span class="n">remind</span><span class="p">):</span> <span class="n">REMINDER_IS_SET</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="k">print</span><span class="p">(</span>
                            <span class="n">log_file</span>
                    <span class="p">)</span>
                <span class="n">message</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Do you want to delete log files &#39;</span> <span class="s1">&#39;for this source? (y/n) &#39;</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">user_says_yes</span><span class="p">(</span> <span class="n">message</span> <span class="o">=</span> <span class="n">message</span> <span class="p">))</span> <span class="p">:</span>
                    <span class="k">for</span> <span class="n">log_file</span> <span class="ow">in</span> <span class="n">log_files</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">log_file</span><span class="p">)</span>
                    <span class="k">print</span><span class="p">(</span>
                            <span class="s1">&#39;Log files deleted.&#39;</span>
                            <span class="p">)</span>
                    <span class="k">continue</span>
                <span class="k">else</span> <span class="p">:</span> <span class="k">continue</span>
        <span class="k">print</span><span class="p">(</span> <span class="s1">&#39;Exiting script...&#39;</span> <span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span> <span class="nb">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>


<p>Running <strong>Black</strong>, we will get something that&#8217;s quite a bit more&nbsp;palatable:</p>
<div class="highlight"><pre><span></span>    <span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="n">data_sources</span><span class="p">:</span>

        <span class="c1"># Retrieve a list of all matching log files in `source`</span>
        <span class="n">log_files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;{source}/{LOG_NAME}*&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">log_files</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">There is no log file to delete in {source}.&quot;</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Log files in {source}:&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">log_file</span> <span class="ow">in</span> <span class="n">log_files</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ARGUMENTS</span><span class="o">.</span><span class="n">remind</span><span class="p">:</span>
                    <span class="n">REMINDER_IS_SET</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="k">print</span><span class="p">(</span><span class="n">log_file</span><span class="p">)</span>
            <span class="n">message</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Do you want to delete log files &quot;</span> <span class="s2">&quot;for this source? (y/n) &quot;</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">user_says_yes</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">message</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">log_file</span> <span class="ow">in</span> <span class="n">log_files</span><span class="p">:</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">log_file</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Log files deleted.&quot;</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">continue</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Exiting script...&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>


<hr>
<h2>Conclusion</h2>
<p>I think the results speak for themselves: enforcing a style with a tool like <strong>Black</strong> is definitely useful to avoid arguments about conflicting coding styles. It lets you focus on what matters instead: being productive while providing value to the&nbsp;world.</p>
  </div>
  <div class="article_meta">
    <p>Posted on: Sat 13 July 2019</p>
    <p>Category: <a href="https://www.sglavoie.com/category/workflow.html">workflow</a>
 &ndash; Tags:
      <a href="https://www.sglavoie.com/tag/neovim.html">neovim</a>,      <a href="https://www.sglavoie.com/tag/plugin.html">plugin</a>,      <a href="https://www.sglavoie.com/tag/productivity.html">productivity</a>,      <a href="https://www.sglavoie.com/tag/terminal.html">terminal</a>,      <a href="https://www.sglavoie.com/tag/vim.html">vim</a>    </p>
  </div>

  <div id="article_comments">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_identifier = "posts/2019/07/13/black-a-python-formatter-to-brighten-your-workflow/";
        (function() {
             var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
             dsq.src = '//sglavoie.disqus.com/embed.js';
             (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
         })();
    </script>
  </div>

</article>


      <div id="ending_message">
        <p>&copy; Sébastien Lavoie. Built in <a href="https://www.python.org/" target="_blank">Python</a> using <a href="http://getpelican.com" target="_blank">Pelican</a>. Theme by Giulio Fidente on <a href="https://github.com/gfidente/pelican-svbhack" target="_blank">GitHub</a>.</p>
      </div>
    </main>
  </body>
</html>