<!DOCTYPE html>
<html lang="en">
<head>
          <title>Exponentiation in Modular Arithmetic Made&nbsp;Easy | sglavoie.com</title>

<link href="https://www.sglavoie.com/feeds/sglavoie.rss.xml" type="application/rss+xml" rel="alternate" title="sglavoie.com Full RSS Feed" />

        <!-- Favicon -->
        <link rel="apple-touch-icon" sizes="180x180" href="/theme/images/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/theme/images/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/theme/images/favicon-16x16.png">
        <link rel="manifest" href="/theme/images/site.webmanifest">
        <link rel="mask-icon" href="/theme/images/safari-pinned-tab.svg" color="#5bbad5">
        <link rel="shortcut icon" href="/theme/images/favicon.ico">
        <meta name="msapplication-TileColor" content="#2d89ef">
        <meta name="msapplication-TileImage" content="/theme/images/mstile-144x144.png">
        <meta name="msapplication-config" content="/theme/images/browserconfig.xml">
        <meta name="theme-color" content="#000000">
        <meta name="msapplication-config" content="/theme/images/browserconfig.xml">
        <meta name="theme-color" content="#000000">

        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta name="description" content="I document my journey as a learner in technology-related matters, explaining the challenges that I face while trying to become a better student. I teach the solutions that I find along the way so that it can benefit others too.">

        <!-- Bootstrap CSS -->
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

        <!-- Font Awesome Icons -->
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">

        <!-- Custom CSS -->
        <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
        <link href='/theme/css/base.css?cache_id=b078f9979dd2b637a582bd124e3b1c91' rel='stylesheet' type='text/css'>
        <link href='/theme/css/pygment.css?cache_id=503914e4e79f274778eabccca9bcd1f9' rel='stylesheet' type='text/css'>



<!-- Open graph for social networks -->
    <meta name="og:title" property="og:title" content="While playing around in the Python interpreter to validate answers to mathematical questions, I quickly found out that very large exponents are dealt with very inefficiently by default as they are simply evaluated as is. That's where Python came to its own rescue.">

    <meta name="tags" content="mathematics" />
    <meta name="tags" content="python" />
    <meta name="tags" content="script" />

</head>

<body id="index" class="home">

<nav id="bg-darker" class="navbar navbar-expand-lg navbar-dark">
      <a class="brand-link" href="/">
          <img class="brand-logo hover-img" src="/theme/images/sglavoie.svg" alt="sglavoie.svg">
      </a>
  <button class="navbar-toggler hover-img" type="button" data-toggle="collapse" data-target="#sglavoie-menu" aria-controls="sglavoie-menu" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
    Main Menu
  </button>

  <div class="collapse navbar-collapse" id="sglavoie-menu">
      <div class="to-the-right">
          <ul class="navbar-nav mr-auto mt-2 mt-lg-0">

        <li class="nav-item">
            <a class="nav-link" href="/index.html"><i class="fas fa-home"></i> home</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="/tags.html"><i class="fas fa-hashtag"></i> tags</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="/learning-progress.html"><i class="fas fa-graduation-cap"></i> learning</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="/about.html"><i class="fas fa-info"></i> about</a>
        </li>
          </ul>
      </div>
  </div>
</nav>

<nav id="menu" class="navbar navbar-expand-lg navbar-dark">

  <button class="navbar-toggler hover-img" type="button" data-toggle="collapse" data-target="#sglavoie-menu-second" aria-controls="sglavoie-menu-second" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
    Categories
  </button>

  <div class="collapse navbar-collapse" id="sglavoie-menu-second">
      <div id="menu-categories-legend-id" class="menu-categories-legend">
          <a href="/categories.html"><img class="img-categories" src="/theme/images/categories.svg" alt="Categories"></a>
      </div>
          <ul class="navbar-nav mr-auto mt-2 mt-lg-0">



              <li class="nav-item">
            <a class="lowercase-title always-white nav-link-smaller" href="https://www.sglavoie.com/category/automation.html">automation</a>
              </li>

              <li class="nav-item">
            <a class="lowercase-title always-white nav-link-smaller" href="https://www.sglavoie.com/category/tips-and-tricks.html">tips-and-tricks</a>
              </li>

              <li class="nav-item">
            <a class="lowercase-title always-white nav-link-smaller" href="https://www.sglavoie.com/category/tools.html">tools</a>
              </li>

              <li class="nav-item">
            <a class="lowercase-title always-white nav-link-smaller" href="https://www.sglavoie.com/category/workflow.html">workflow</a>
              </li>

          </ul>
  </div>
</nav>
        <!-- /#menu -->


    <section id="content" class="jumbotron body">
        <header>
            <h2 class="display-4">
                <a href="https://www.sglavoie.com/posts/2019/04/27/exponentiation-in-modular-arithmetic-made-easy/" rel="bookmark"
                    title="Permalink to Exponentiation in Modular Arithmetic Made Easy">Exponentiation in Modular Arithmetic Made&nbsp;Easy</a></h2>
            
        </header>
        <footer class="post-info">
            <i class="fas fa-calendar-alt"></i> <time class="published" datetime="2019-04-27T19:52:00-05:00">
                April 27, 2019
            </time>
            <address class="vcard author">
            </address>
            <div class="category">
                <i class="fas fa-tag"></i> Category: <a class="emphasis post-info-space" href="https://www.sglavoie.com/category/automation.html">automation</a>
            </div>
            <div class="tags">
                <i class="fas fa-hashtag"></i> Tags:
                <a class="emphasis post-info-space" href="https://www.sglavoie.com/tag/mathematics.html">mathematics</a>
                <a class="emphasis post-info-space" href="https://www.sglavoie.com/tag/python.html">python</a>
                <a class="emphasis post-info-space" href="https://www.sglavoie.com/tag/script.html">script</a>
            </div>
        </footer><!-- /.post-info -->
  <hr class="my-4">
  <div class="card">
      <div class="card-body entry-content">
          <p>The following Python script will by no means provide any useful idea to
compete against the
 <a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)"><span class="caps">RSA</span> algorithm</a>
 <i class="fab fa-wikipedia-w"></i>, but it does give you an idea of how
a simple technique about reducing the size of an exponent in modular
arithmetic can bring you closer to using much larger numbers than the
ones you could normally use in the Python&nbsp;interpreter.</p>
<h2>The script in&nbsp;action</h2>
<div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Compute the result of a^b (mod k) by using the exponentiation technique.</span>
<span class="sd">The goal here is not efficiency, even though the program is actually pretty</span>
<span class="sd">fast: the algorithm is applied manually for demonstration purposes.</span>
<span class="sd">Testing on a modest Intel Core i5, having `a` and `b` each set to a random</span>
<span class="sd">number containing 2,000 digits and `k` set to a modulo of a number containing</span>
<span class="sd">20 digits, results are printed in about 3.3 seconds.&quot;&quot;&quot;</span>

<span class="k">def</span> <span class="nf">binary_remainders</span><span class="p">(</span><span class="n">num_b</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Take `b` and return the binary equivalent in a list of remainders.&quot;&quot;&quot;</span>
    <span class="n">remainders</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">quotient</span> <span class="o">=</span> <span class="n">num_b</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">prev_quotient</span> <span class="o">=</span> <span class="n">quotient</span>
        <span class="n">quotient</span> <span class="o">//=</span> <span class="mi">2</span>
        <span class="n">remainder</span> <span class="o">=</span> <span class="n">prev_quotient</span> <span class="o">%</span> <span class="mi">2</span>
        <span class="n">remainders</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">remainder</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">quotient</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="k">return</span> <span class="n">remainders</span>


<span class="k">def</span> <span class="nf">powers_of_two</span><span class="p">(</span><span class="n">remainders</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return a list of the value of powers of two that form the</span>
<span class="sd">    exponent`b`.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">remainders</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>

    <span class="n">powers</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">remainder</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">remainders</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">remainder</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">powers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">index</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">powers</span>


<span class="k">def</span> <span class="nf">compute_intermediate_congruences</span><span class="p">(</span><span class="n">num_a</span><span class="p">,</span> <span class="n">num_k</span><span class="p">,</span> <span class="n">powers</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compute all necessary intermediate results of congruence in `mod k` for</span>
<span class="sd">    powers of 2 in `powers` to form the number `b`.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">powers</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>

    <span class="n">go_up_to</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">powers</span><span class="p">)</span>

    <span class="n">intermediate_results</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="n">num_a</span><span class="p">}</span>  <span class="c1"># Build dictionary to store all results</span>
    <span class="n">start_value</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># First power of two to calculate congruence</span>
    <span class="n">congruence</span> <span class="o">=</span> <span class="n">num_a</span>
    <span class="k">while</span> <span class="n">start_value</span> <span class="o">&lt;=</span> <span class="n">go_up_to</span><span class="p">:</span>
        <span class="c1"># value to use for next power of 2</span>
        <span class="n">congruence</span> <span class="o">=</span> <span class="n">congruence</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">%</span> <span class="n">num_k</span>
        <span class="n">intermediate_results</span><span class="p">[</span><span class="n">start_value</span><span class="p">]</span> <span class="o">=</span> <span class="n">congruence</span>
        <span class="n">start_value</span> <span class="o">*=</span> <span class="mi">2</span>

    <span class="k">return</span> <span class="n">intermediate_results</span>


<span class="k">def</span> <span class="nf">compute_final_congruence</span><span class="p">(</span><span class="n">num_k</span><span class="p">,</span> <span class="n">powers</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">intermediate_results</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Take all relevant values from `intermediate_results` matching powers in</span>
<span class="sd">    `powers`, multiply them together and calculate this number `mod k` to get</span>
<span class="sd">    the final result.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">intermediate_results</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">powers</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>

    <span class="c1"># store all required values from `intermediate_results`</span>
    <span class="n">congruent_results</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">power</span> <span class="ow">in</span> <span class="n">powers</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">intermediate_results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="n">power</span><span class="p">:</span>
                <span class="n">congruent_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="n">total</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">congruent_results</span><span class="p">:</span>
        <span class="n">total</span> <span class="o">=</span> <span class="n">result</span> <span class="o">*</span> <span class="n">total</span>  <span class="c1"># Multiply all results together</span>

    <span class="k">return</span> <span class="n">total</span> <span class="o">%</span> <span class="n">num_k</span>  <span class="c1"># final congruence we are looking for</span>


<span class="k">def</span> <span class="nf">compute_congruence</span><span class="p">(</span><span class="n">num_a</span><span class="p">,</span> <span class="n">num_b</span><span class="p">,</span> <span class="n">num_k</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return `c`, the result of `a^b (mod k)`.&quot;&quot;&quot;</span>
    <span class="n">num_a</span> <span class="o">=</span> <span class="n">num_a</span> <span class="o">%</span> <span class="n">num_k</span>  <span class="c1"># Make sure `a` is smaller than `k`</span>

    <span class="c1"># Reduce `b` to list of remainders in binary</span>
    <span class="n">remainders</span> <span class="o">=</span> <span class="n">binary_remainders</span><span class="p">(</span><span class="n">num_b</span><span class="p">)</span>

    <span class="c1"># Build a list of the powers of 2 forming `b`</span>
    <span class="n">powers</span> <span class="o">=</span> <span class="n">powers_of_two</span><span class="p">(</span><span class="n">remainders</span><span class="p">)</span>

    <span class="c1"># Build a list of necessary intermediate results to reach</span>
    <span class="c1"># the value of `b` from powers of 2: finds congruence for</span>
    <span class="c1"># smaller powers of 2 and store them in a list.</span>
    <span class="n">intermediate_results</span> <span class="o">=</span> <span class="n">compute_intermediate_congruences</span><span class="p">(</span><span class="n">num_a</span><span class="p">,</span> <span class="n">num_k</span><span class="p">,</span>
                                                            <span class="n">powers</span><span class="p">)</span>

    <span class="c1"># Multiply all relevant intermediate results `mod k` to get the final</span>
    <span class="c1"># congruence of `a^b (mod k)`.</span>
    <span class="k">return</span> <span class="n">compute_final_congruence</span><span class="p">(</span><span class="n">num_k</span><span class="p">,</span> <span class="n">powers</span><span class="p">,</span> <span class="n">intermediate_results</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;We will calculate a^b (mod k). Enter only integers.&quot;</span><span class="p">)</span>
    <span class="n">NUM_A</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Provide `a`: &quot;</span><span class="p">))</span>
    <span class="n">NUM_B</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Provide `b`: &quot;</span><span class="p">))</span>
    <span class="n">NUM_K</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Provide `k`: &quot;</span><span class="p">))</span>

    <span class="n">FINAL_RESULT</span> <span class="o">=</span> <span class="n">compute_congruence</span><span class="p">(</span><span class="n">NUM_A</span><span class="p">,</span> <span class="n">NUM_B</span><span class="p">,</span> <span class="n">NUM_K</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">FINAL_RESULT</span><span class="p">)</span>
</pre></div>


<h2>Conclusion</h2>
<p>It was very interesting to see how a technique that&#8217;s applied manually
will work wonders with such large numbers. The Python interpreter can
barely calculate numbers with exponents with seven digits or more, while
a basic approach like the one shown above can quickly churn out the
results for seemingly quite large&nbsp;numbers.</p>
<p>As always, this code is
 <a href="https://github.com/sglavoie/code-snippets/blob/master/python/mathematics/modular_arithmetic/exponentiation_mod_k.py">available on GitHub</a> <i class="fab fa-github-alt"></i>.</p>
      </div>
  </div>
        <!-- /.entry-content -->

	<hr>

	<h2 class="display-4"><i class="fas fa-comment-alt"></i> Comments</h2>
<div id="disqus_thread"></div>
<script type="text/javascript">
    // Substitute single quotation mark (') for double (") to allow
    // article's title to contain single quotes.
    var disqus_shortname = "sglavoie"; 
    var disqus_title = "Exponentiation in Modular Arithmetic Made&nbsp;Easy";

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


    </section>

    <div class="footer-borders">
        <footer id="contentinfo" class="body bg-border hover-footer-bg">

    <address class="footer-icons">

        <div class="get-in-touch-icons">
        <ul class="social-footer">

        <li><a href="https://github.com/sglavoie"><img src="/theme/images/footer/github.svg" alt="GitHub"></a></li>
        <li><a href="https://www.twitter.com/sgdlavoie"><img src="/theme/images/footer/twitter.svg" alt="Twitter"></a></li>
        <li><a href="https://www.linkedin.com/in/sglavoie"><img src="/theme/images/footer/linkedin.svg" alt="LinkedIn"></a></li>
        <li><a href="https://www.hackerrank.com/sglavoie"><img src="/theme/images/footer/hackerrank.svg" alt="HackerRank"></a></li>
        <li><a href="https://stackoverflow.com/users/story/8787680"><img src="/theme/images/footer/stackoverflow.svg" alt="Stackoverflow"></a></li>

    </div>

  </address>

  <address id="about" class="vcard body">
      Proudly powered by <a href="http://getpelican.com/">Pelican 4.0.1<img class="mini-icon" src="/theme/images/footer/pelican.svg" alt="Pelican"></a>,
      which takes great advantage of <a href="http://python.org">Python<img class="mini-icon" src="/theme/images/footer/python.svg" alt="Python"></a> .

  <div id="author-footer">
      <p>Copyleft <span class="copy-left">©</span> 2019 — Sébastien Lavoie
          <script type="text/javascript" language="javascript">
              <!--
// Email obfuscator script 2.1 by Tim Williams, University of Arizona
// Random encryption key feature coded by Andrew Moulden
// This code is freeware provided these four comment lines remain intact
// A wizard to generate this code is at http://www.jottings.com/obfuscator/
{ coded = "Efp9ExWfz@EoU9R5Wf.45D"
key = "RXmOLk0xFelpj9ihYV4PZ5AGDB3wsKdfUn12WHJgvqNIrCytS8EbQa6zuMc7To"
shift=coded.length
link=""
for (i=0; i<coded.length; i++) {
    if (key.indexOf(coded.charAt(i))==-1) {
        ltr = coded.charAt(i)
        link += (ltr)
    }
    else {
        ltr = (key.indexOf(coded.charAt(i))-shift+key.length) % key.length
        link += (key.charAt(ltr))
    }
}
// Adding inline style to 'img' tag as it seems to be more trustworthy inside this script.
document.write("<a href='mailto:"+link+"'>"+"<img class='mini-icon' src='/theme/images/footer/email.svg' alt='Email'>"+"</a>")
}
//-->
          </script><noscript>Sorry, you need Javascript on to email me.</noscript>
      </p>
  </div>
            </address>

          <div class="version-footer">v0.15.0</div>

            <!-- /#about -->
        </footer>

    </div>
    <!-- /#contentinfo -->

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

    <!-- Disqus comment counts for each article -->
<script id="dsq-count-scr" src="https://sglavoie.disqus.com/count.js" async></script>
</body>
</html>