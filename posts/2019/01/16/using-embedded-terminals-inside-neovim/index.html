<!DOCTYPE html>
<html lang="en">

  <head>
      <link rel="stylesheet" type="text/css" href="https://www.sglavoie.com/theme/css/style.css">
      <link rel="stylesheet" type="text/css" href="https://www.sglavoie.com/theme/css/pygments.css">
      <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=PT+Sans|PT+Serif|PT+Mono">

      <meta charset="utf-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="author" content="Sébastien Lavoie">
      <meta name="description" content="Posts and writings by Sébastien Lavoie">

      <link href="https://www.sglavoie.com/feeds/sglavoie.rss.xml" type="application/rss+xml" rel="alternate" title="sglavoie.com RSS" />

      <!-- Favicon -->
      <link rel="apple-touch-icon" sizes="180x180" href="/theme/favicon/apple-touch-icon.png">
      <link rel="icon" type="image/png" sizes="32x32" href="/theme/favicon/favicon-32x32.png">
      <link rel="icon" type="image/png" sizes="16x16" href="/theme/favicon/favicon-16x16.png">
      <link rel="manifest" href="/theme/favicon/site.webmanifest">
      <link rel="mask-icon" href="/theme/favicon/safari-pinned-tab.svg" color="#5bbad5">
      <link rel="shortcut icon" href="/theme/favicon/favicon.ico">
      <meta name="msapplication-TileColor" content="#2d89ef">
      <meta name="msapplication-TileImage" content="/theme/favicon/mstile-144x144.png">
      <meta name="msapplication-config" content="/theme/favicon/browserconfig.xml">
      <meta name="theme-color" content="#000000">
      <meta name="msapplication-config" content="/theme/favicon/browserconfig.xml">
      <meta name="theme-color" content="#000000">

      <meta name="keywords" content="neovim, productivity, terminal">

      <!-- Open graph for social networks -->
      <meta name="og:title" property="og:title" content="Because every pixel counts, this neat trick will allow to use terminals inside Neovim and maximize the screen estate for a flawless integration with one of the best text editor available.">

      <title>
        sglavoie.com
&ndash; Using Embedded Terminals Inside&nbsp;Neovim      </title>

<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-150998392-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
  </head>

  <body>
    <aside>
      <div id="user_meta">
        <a href="https://www.sglavoie.com">
          <img src="https://www.sglavoie.com/theme/images/logo.png" alt="logo">
        </a>
        <h2><a href="https://www.sglavoie.com">sglavoie.com</a></h2>
        <p></p>
        <ul>
          <li><a href="https://www.sglavoie.com/category/automation.html">automation</a></li>
          <li><a href="https://www.sglavoie.com/category/tips-and-tricks.html">tips-and-tricks</a></li>
          <li><a href="https://www.sglavoie.com/category/tools.html">tools</a></li>
          <li><a href="https://www.sglavoie.com/category/workflow.html">workflow</a></li>
        </ul>
      </div>
    </aside>

    <main>
      <header>
        <p>
        <a href="https://www.sglavoie.com">Index</a> &brvbar; <a href="https://www.sglavoie.com/archives.html">Archives</a>
        &brvbar; <a href="https://www.sglavoie.com/tags.html">Tags</a>
        &brvbar; <a href="https://www.sglavoie.com/learning-progress-2019.html">Learning Progress</a>
        &brvbar; <a href="https://www.sglavoie.com/feeds/sglavoie.rss.xml">RSS</a>
        </p>
      </header>

<article>
  <div class="article_title">
    <h1><a href="https://www.sglavoie.com/posts/2019/01/16/using-embedded-terminals-inside-neovim/">Using Embedded Terminals Inside&nbsp;Neovim</a></h1>
  </div>
  <div class="article_readtime">
    <p>Estimated read time: 4 minutes</p>
  </div>
  <div class="article_text">
    <h2>Terminals <span class="amp">&amp;</span>&nbsp;Neovim</h2>
<p>Terminal buffers are a built-in feature of <code>Neovim</code>. This means that
terminals can be launched inside Neovim just like any other buffer, may
it be a split window, a new tab or an independent buffer. Why is this so
useful? Be prepared to be&nbsp;amazed.</p>
<p><a href="https://www.sglavoie.com/images/posts/0006_using-embedded-terminals-inside-neovim/work_on_article.png"><img src="https://www.sglavoie.com/images/posts/0006_using-embedded-terminals-inside-neovim/work_on_article.png" alt="embedded-terminal" class="max-size-img-post"></a></p>
<p><a href="https://www.sglavoie.com/images/posts/0006_using-embedded-terminals-inside-neovim/terminal_buffers.png"><img src="https://www.sglavoie.com/images/posts/0006_using-embedded-terminals-inside-neovim/terminal_buffers.png" alt="terminal-buffers" class="max-size-img-post"></a></p>
<p>(click to&nbsp;open)</p>
<h3>Seamless integration with Vim&nbsp;commands</h3>
<p>For a start, terminals are not just <em>opened</em> inside Neovim: they are
truly integrated. When you type the letter <code>i</code> in a terminal buffer,
it switches to a new mode, <code>Terminal</code>, where you have access to all
underlying features of a regular Bash terminal, such as <code>CTRL + r</code>
to search, tab completion of commands, <code>CTRL + w</code> to delete a word
backwards or <code>CTRL + u</code> to delete the whole line&nbsp;backwards.</p>
<p>When you escape the <code>Terminal</code> mode, you switch back to <code>Normal</code> mode,
where all Vim commands are available as usual, such as navigation,
search, etc. Where this gets interesting is when you consider that the
terminal is just like any other buffer (except it&#8217;s not <em>modifiable</em>)
and so you can for instance copy its content or paste into it from
different registers. You can split them, view the line number, get
automatic scrolling when output appears in <code>Insert</code> mode, you can switch
back to <code>Normal</code> mode at any time even if a command hasn&#8217;t completed&#8230;
and of course all commands like <code>gt</code> to <strong>g</strong>o to another <strong>t</strong>ab work
as&nbsp;always.</p>
<h3>Terminals get supercharged with the power of&nbsp;Vim</h3>
<p>This is getting exciting (at least for me). Now, having a terminal with
more power is useful in many&nbsp;cases:</p>
<ul>
<li>
<p>A whole terminal session can be saved to another file easily by
copying the desired range (<code>:%y</code> to copy everything, for&nbsp;example).</p>
</li>
<li>
<p>Instead of having to scroll with the mouse, all Vim commands are
available to search and navigate through the buffer: <code>gg</code> to go to the
beginning of the session, <code>G</code> to go to the end, <code>12G</code> to go to line
number <strong>12</strong>, <code>/</code> or <code>?</code> to search forward and backward respectively.
You can even set local or global marks to jump back and forth to precise
lines&nbsp;consistently!</p>
</li>
<li>
<p>It&#8217;s even possible to send commands directly to a specific
terminal or set up a <span class="caps">REPL</span> to execute any code, either a
selection, a line or a range of lines. I don&#8217;t personally
use that feature yet, but I see how useful that can be and
you can too if you watch this <a href="https://thoughtbot.com/upcase/videos/neovim-sending-commands-to-a-
terminal-buffer">screencast presented by Drew
Neil</a> on
<a href="https://thoughtbot.com">thoughtbot.com</a>.</p>
</li>
<li>
<p>If the terminal is opened in <code>Normal</code> mode, the cursor and the current
position are kept intact even though new output could appear, such as
would be the case if you are running a server in the background or
waiting for a system update to finish. This is especially nice for
instance if you are trying to debug a web application: you can leave the
cursor exactly where you would like to keep reading the output and never
get lost&#8230; Plus you have the ability to easily move around, search and
copy like a&nbsp;ninja!</p>
</li>
</ul>
<h3>The workflow is more compact and&nbsp;centralized</h3>
<p>Because the terminals are running with one Neovim instance, you get
everything in the same place, which is usually how you need to access
your work anyway. If for some reasons you need to have multiple
instances of Neovim running, this is possible too and in that situation
you could simply split them into different&nbsp;workspaces.</p>
<p>Because everything is launched with Neovim, every terminal left open
will also be exited when you close Neovim, shutting down any server
or quitting any background interaction going on in the terminals. I
have found that this behaviour is what I expect pretty much all the
time because the idea of having a terminal inside a working session
of Neovim is to work on something related, so it makes sense to close
everything that&#8217;s to do with a single project or task when you exit the
text editor. No need for <code>CTRL + d</code> or <code>exit</code> anymore!</p>
<hr>
<h2>Terminal settings to&nbsp;consider</h2>
<p>I don&#8217;t use many settings or mappings related to terminals, but I guess
the nicest one is to remap the <code>Escape</code> key because by default, this is
a weird mapping that leads to twisted fingers (<code>&lt;C-\&gt;&lt;C-n&gt;</code>). Here is
what I currently have in my <code>init.vim</code> file (the equivalent of <code>.vimrc</code>
for&nbsp;Neovim):</p>
<div class="highlight"><pre><span></span><span class="k">set</span> termguicolors  <span class="c">&quot; Make colors look better in terminal</span>

<span class="c">&quot; Exit from terminal buffer (Neovim) more easily (remaps Esc key in</span>
<span class="c">&quot; terminal)</span>
tnoremap <span class="p">&lt;</span>C<span class="p">-</span>[<span class="p">&gt;</span> <span class="p">&lt;</span>C<span class="p">-</span>\<span class="p">&gt;&lt;</span>C<span class="p">-</span><span class="k">n</span><span class="p">&gt;</span>

<span class="c">&quot; Open terminal buffer (M stands for the Alt key)</span>
<span class="nb">nnoremap</span> <span class="p">&lt;</span>M<span class="p">-</span><span class="k">t</span><span class="p">&gt;</span> :<span class="k">te</span><span class="p">&lt;</span>CR<span class="p">&gt;</span>

<span class="c">&quot; Switch to terminal buffer automatically (when only one terminal is</span>
<span class="c">&quot; open)</span>
<span class="nb">nnoremap</span> <span class="p">&lt;</span>M<span class="m">-0</span><span class="p">&gt;</span> :<span class="k">b</span> <span class="nb">term</span>:<span class="sr">//</span><span class="p">&lt;</span>CR<span class="p">&gt;</span>

<span class="c">&quot; Move between windows exactly the same way as usual</span>
tnoremap <span class="p">&lt;</span>C<span class="p">-</span><span class="k">j</span><span class="p">&gt;&lt;</span>C<span class="p">-</span><span class="k">k</span><span class="p">&gt;</span> <span class="p">&lt;</span>C<span class="p">-</span>\<span class="p">&gt;&lt;</span>C<span class="p">-</span>N<span class="p">&gt;</span>
tnoremap <span class="p">&lt;</span>C<span class="p">-</span><span class="k">h</span><span class="p">&gt;</span> <span class="p">&lt;</span>C<span class="p">-</span>\<span class="p">&gt;&lt;</span>C<span class="p">-</span>N<span class="p">&gt;&lt;</span>C<span class="p">-</span><span class="k">w</span><span class="p">&gt;</span><span class="k">h</span>
tnoremap <span class="p">&lt;</span>C<span class="p">-</span><span class="k">j</span><span class="p">&gt;</span> <span class="p">&lt;</span>C<span class="p">-</span>\<span class="p">&gt;&lt;</span>C<span class="p">-</span>N<span class="p">&gt;&lt;</span>C<span class="p">-</span><span class="k">w</span><span class="p">&gt;</span><span class="k">j</span>
tnoremap <span class="p">&lt;</span>C<span class="p">-</span><span class="k">k</span><span class="p">&gt;</span> <span class="p">&lt;</span>C<span class="p">-</span>\<span class="p">&gt;&lt;</span>C<span class="p">-</span>N<span class="p">&gt;&lt;</span>C<span class="p">-</span><span class="k">w</span><span class="p">&gt;</span><span class="k">k</span>
tnoremap <span class="p">&lt;</span>C<span class="p">-</span><span class="k">l</span><span class="p">&gt;</span> <span class="p">&lt;</span>C<span class="p">-</span>\<span class="p">&gt;&lt;</span>C<span class="p">-</span>N<span class="p">&gt;&lt;</span>C<span class="p">-</span><span class="k">w</span><span class="p">&gt;</span><span class="k">l</span>
</pre></div>


<hr>
<h2>Conclusion</h2>
<p>This was a quick overview of a feature that I have neglected for some
time but recently realized how well it integrates with my workflow. You
can find some more information by typing <code>:h terminal</code>. If you already
use Neovim, it&#8217;s worth giving it a try! Otherwise, it&#8217;s worth giving
<a href="https://neovim.io/">Neovim</a> a&nbsp;try.</p>
  </div>
  <div class="article_meta">
    <p>Posted on: Wed 16 January 2019</p>
    <p>Category: <a href="https://www.sglavoie.com/category/tips-and-tricks.html">tips-and-tricks</a>
 &ndash; Tags:
      <a href="https://www.sglavoie.com/tag/neovim.html">neovim</a>,      <a href="https://www.sglavoie.com/tag/productivity.html">productivity</a>,      <a href="https://www.sglavoie.com/tag/terminal.html">terminal</a>    </p>
  </div>

  <div id="article_comments">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_identifier = "posts/2019/01/16/using-embedded-terminals-inside-neovim/";
        (function() {
             var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
             dsq.src = '//sglavoie.disqus.com/embed.js';
             (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
         })();
    </script>
  </div>

</article>


      <div id="ending_message">
        <p>&copy; Sébastien Lavoie. Built in <a href="https://www.python.org/" target="_blank">Python</a> using <a href="http://getpelican.com" target="_blank">Pelican</a>. Theme by Giulio Fidente on <a href="https://github.com/gfidente/pelican-svbhack" target="_blank">GitHub</a>.</p>
      </div>
    </main>
  </body>
</html>