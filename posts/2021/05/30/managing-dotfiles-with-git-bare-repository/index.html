<!DOCTYPE html>
<html lang="en">
    <head>
        <link
            rel="stylesheet"
            type="text/css"
            href="../../../../../theme/css/style.css"
        />
        <link
            rel="stylesheet"
            type="text/css"
            href="../../../../../theme/css/pygments.css"
        />

        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="author" content="Sébastien Lavoie" />
        <meta
            name="description"
            content="Posts and writings by Sébastien Lavoie. Customization setups and articles on productivity for developers who like minimalism."
        />
        <meta name="title" property="og:title" content="sglavoie.com" />
        <meta property="og:type" content="Website" />
        <meta
            name="image"
            property="og:image"
            content="../../../../../theme/images/logo_1200x627.png"
        />

         <link
            href="https://www.sglavoie.com/feeds/sglavoie.rss.xml"
            type="application/rss+xml"
            rel="alternate"
            title="sglavoie.com RSS"
        />

        <!-- Favicon -->
        <link
            rel="apple-touch-icon"
            href="/theme/favicon/apple-touch-icon.png"
        />
        <link
            rel="icon"
            type="image/png"
            sizes="32x32"
            href="/theme/favicon/favicon-32x32.png"
        />
        <link
            rel="icon"
            type="image/png"
            sizes="16x16"
            href="/theme/favicon/favicon-16x16.png"
        />
        <link rel="manifest" href="/theme/favicon/site.webmanifest" />
        <link
            rel="mask-icon"
            href="/theme/favicon/safari-pinned-tab.svg"
            color="#5bbad5"
        />
        <link rel="shortcut icon" href="/theme/favicon/favicon.ico" />
        <meta name="msapplication-TileColor" content="#2d89ef" />
        <meta
            name="msapplication-TileImage"
            content="/theme/favicon/mstile-144x144.png"
        />
        <meta
            name="msapplication-config"
            content="/theme/favicon/browserconfig.xml"
        />
        <meta name="theme-color" content="#000000" />
        <meta
            name="msapplication-config"
            content="/theme/favicon/browserconfig.xml"
        />
        <meta name="theme-color" content="#000000" />

<meta name="keywords" content="dotfiles, git, terminal">

<!-- Open graph for social networks -->
<meta name="og:title" property="og:title" content="Keeping configuration files under version control with a Git bare repository is a fast, elegant and convenient solution!">

        <title>sglavoie.com &ndash; Managing dotfiles with a Git bare&nbsp;repository</title>

        <!-- Enable tracking of web traffic -->
<script type="text/javascript">
    var _gaq = _gaq || []
    _gaq.push(['_setAccount', 'UA-150998392-1'])
    _gaq.push(['_trackPageview'])
    ;(function () {
        var ga = document.createElement('script')
        ga.type = 'text/javascript'
        ga.async = true
        ga.src =
            ('https:' == document.location.protocol
                ? 'https://ssl'
                : 'http://www') + '.google-analytics.com/ga.js'
        var s = document.getElementsByTagName('script')[0]
        s.parentNode.insertBefore(ga, s)
    })()
</script>
     </head>

    <body>
        <aside>
            <div id="user_meta">
                <a href="../../../../..">
                    <div>
                        <svg
                            width="24.348mm"
                            height="24.348mm"
                            version="1.1"
                            viewBox="0 0 24.348095 24.347754"
                            xmlns="http://www.w3.org/2000/svg"
                            xmlns:cc="http://creativecommons.org/ns#"
                            xmlns:dc="http://purl.org/dc/elements/1.1/"
                            xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
                        >
                            <metadata>
                                <rdf:RDF>
                                    <cc:Work rdf:about="">
                                        <dc:format>image/svg+xml</dc:format>
                                        <dc:type
                                            rdf:resource="http://purl.org/dc/dcmitype/StillImage"
                                        />
                                        <dc:title />
                                    </cc:Work>
                                </rdf:RDF>
                            </metadata>
                            <g transform="translate(81.397 -84.454)">
                                <path
                                    d="m-57.049 105.9v2.9029h-11.173v-2.9029z"
                                    fill="#c0c0c0"
                                >
                                    <animate
                                        attributeName="fill"
                                        values="white;grey;white"
                                        dur="2s"
                                        repeatCount="indefinite"
                                    />
                                </path>
                                <path
                                    d="m-72.272 98.481-9.1246 5.7598v-3.548l5.8658-3.5019v-0.09215l-5.8658-3.5019v-3.548l9.1246 5.7598z"
                                    fill="#c0c0c0"
                                />
                                <path
                                    transform="scale(.26458)"
                                    d="m-273.15 319.2-27.588 14.77 8.498 5.3613 19.09-12.049zm15.309 25.67v44.412h8.8672v-35.635h33.361v-8.7773h-33.783zm25.336 24.66v8.7774h8.0254v10.975h8.8672v-19.752z"
                                    fill="#007bff"
                                />
                            </g>
                        </svg>
                    </div>
                </a>
                <ul>
                      <li><a href="../../../../../category/automation.html">automation</a></li>
                    <li><a href="../../../../../category/tips-and-tricks.html">tips-and-tricks</a></li>
                    <li><a href="../../../../../category/tools.html">tools</a></li>
                    <li><a href="../../../../../category/workflow.html">workflow</a></li>
                  </ul>
            </div>
        </aside>

        <main>
            <header>
                <p>
                    <a href="../../../../..">Home</a> &brvbar;
                    <a href="../../../../../archives.html">Archives</a> &brvbar;
                    <a href="../../../../../tags.html">Tags</a> &brvbar;
                    <a href="../../../../../learning-progress.html"
                        >Learning Progress</a
                    >
                    &brvbar;
                    <a href="../../../../../contact.html">Contact</a> &brvbar;
                    <a
                        href="https://drive.google.com/file/d/1t6GdZjC13naJXVGe6RinGowZLfkRzjy_/view"
                        target="_blank"
                        rel="noopener noreferrer"
                        >Resume</a
                    >
                </p>
            </header>

<article>
  <div class="article_title">
    <h1><a href="../../../../../posts/2021/05/30/managing-dotfiles-with-git-bare-repository/">Managing dotfiles with a Git bare&nbsp;repository</a></h1>
  </div>
  <div class="flex-container">
    <div class="article_meta">
      <div>Posted on: Sun 30 May 2021</div>
      <div>
        <time class="modified" datetime="2022-04-03T11:49:00-05:00">
          Modified on: Sun 03 April 2022
        </time>
      </div>
      <div>Category: <a href="../../../../../category/workflow.html">workflow</a>
 &ndash; Tags:
        <a href="../../../../../tag/dotfiles.html">dotfiles</a>,        <a href="../../../../../tag/git.html">git</a>,        <a href="../../../../../tag/terminal.html">terminal</a>      </div>
    </div>
    <div class="article_readtime">
      Estimated read time: 5 minutes
    </div>
  </div>

  <h2 class="toc-title">Table of contents</h2>
  </div>
  <nav class="toc">
    <div class="toc">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#1-set-up-the-system">1. Set up the system</a><ul>
<li><a href="#11-create-a-repository-to-host-your-dotfiles">1.1 Create a repository to host your dotfiles</a></li>
<li><a href="#12-set-the-remote-to-track-your-dotfiles">1.2 Set the remote to track your dotfiles</a></li>
</ul>
</li>
<li><a href="#2-use-the-new-system">2. Use the new system</a><ul>
<li><a href="#21-on-your-current-machine">2.1 On your current machine</a></li>
<li><a href="#22-on-a-different-machine">2.2 On a different machine</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a><ul>
<li><a href="#more-resources-and-references">More resources and references</a></li>
</ul>
</li>
</ul>
</div>
  </nav>
  <div class="article_text">
    
<hr/>
<h1 id="introduction">Introduction</h1>
<p>I have been managing my configuration files for the past year using a technique I originally came across in <a href="https://www.youtube.com/watch?v=tBoLDpTWVOM">this YouTube video from DistroTube</a>. This uses a Git bare repository instead of the “usual” way, which consists of using a normal Git repository where one would store the actual configuration files and create symbolic links to all those files to the expected path on the system.</p>
<p>Needless to say, symlinks are a pain to manage when potentially hundreds of files need to be tracked in this way. Fortunately, working with a bare repository is much simpler: there’s neither a need to move files around nor store any of them in the dotfiles bare repository either. Let’s dive in to see how this works! I’ll keep the instructions to the point: for more details, please refer to the article <a href="https://www.atlassian.com/git/tutorials/dotfiles">The best way to store your dotfiles: A bare Git repository</a> from Atlassian, the source of knowledge behind this post.</p>
<hr/>
<h1 id="1-set-up-the-system">1. Set up the system</h1>
<p>Open a terminal and brace yourself to type a few commands. This will need to be done only once on any machine you use.</p>
<p>Set the following variable to the name of the directory where you want to store your dotfiles (e.g. <code>.dotfiles</code>, <code>dotfiles</code>, <code>cfg</code>, etc.):</p>
<div class="highlight"><pre><span></span><code><span class="nv">DOTFILES</span><span class="o">=</span>dotfiles
</code></pre></div>
<p>Then type the following commands:</p>
<div class="highlight"><pre><span></span><code>git init --bare <span class="nv">$HOME</span>/<span class="nv">$DOTFILES</span>
<span class="nb">alias</span> <span class="nv">config</span><span class="o">=</span><span class="s1">'/usr/bin/git --git-dir=$HOME/$DOTFILES/ --work-tree=$HOME'</span>
config config --local status.showUntrackedFiles no
</code></pre></div>
<p>Depending on where you store your terminal aliases (e.g. <code>.bashrc</code>, <code>.zshrc</code>, <code>.bash_aliases</code>, etc.), set the following variable according to your needs:</p>
<div class="highlight"><pre><span></span><code><span class="nv">ALIASES</span><span class="o">=</span>.bash_aliases
</code></pre></div>
<p>Once that is done, type the following command (or open the file containing your aliases with a text editor to manually put the alias wherever you want):</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span> <span class="s2">"alias config='/usr/bin/git --git-dir=</span><span class="nv">$HOME</span><span class="s2">/</span><span class="nv">$DOTFILES</span><span class="s2">/ --work-tree=</span><span class="nv">$HOME</span><span class="s2">'"</span> &gt;&gt; <span class="nv">$HOME</span>/<span class="nv">$ALIASES</span>
</code></pre></div>
<p>You can of course change the <code>config</code> alias to something else. I like to simply use <code>c</code> instead.</p>
<h2 id="11-create-a-repository-to-host-your-dotfiles">1.1 Create a repository to host your dotfiles</h2>
<p>At this point, you will want to make sure you have created an empty Git repository on a website such as <a href="https://github.com/">GitHub</a>, <a href="https://gitlab.com/">GitLab</a> or <a href="https://bitbucket.org/">BitBucket</a>. In the interface of that website, you should find a place that allows you to copy the link to that Git repository, which might look like something like this: <code>git@github.com:username/dotfiles.git</code>.</p>
<h2 id="12-set-the-remote-to-track-your-dotfiles">1.2 Set the remote to track your dotfiles</h2>
<p>With your new Git repository created in the previous step, you will now want to add tracking information to be able to connect to the remote Git repository. You can do so as follows:</p>
<div class="highlight"><pre><span></span><code>config remote set-url origin git@github.com:username/dotfiles.git
</code></pre></div>
<p>For more information about this, you can read the article <a href="https://www.sglavoie.com/posts/2020/10/03/setting-up-ssh-and-git-for-multiple-accounts/">Setting up <span class="caps">SSH</span> and Git for Multiple Accounts</a> if you’ll be using an <span class="caps">SSH</span> key to connect and more specifically <a href="https://git-scm.com/docs/git-remote">the official documentation on the <code>git remote</code> command</a>.</p>
<hr/>
<h1 id="2-use-the-new-system">2. Use the new system</h1>
<h2 id="21-on-your-current-machine">2.1 On your current machine</h2>
<p>Tracking changes will now be a breeze! All we have to do is to add files with our new alias (assuming <code>config</code> was chosen) to Git, commit and push to a remote repository to keep everything neatly backed up.</p>
<p>A typical workflow will look like this:</p>
<div class="highlight"><pre><span></span><code>config status
config add .gitconfig
config commit -m <span class="s2">"Add .gitconfig"</span>
config add .zshrc
config commit -m <span class="s2">"Add .zshrc"</span>
config push
</code></pre></div>
<h2 id="22-on-a-different-machine">2.2 On a different machine</h2>
<p>Once yet have set up the system once with a remote repository, then the process becomes simpler as you can clone that repository and save a few steps. Here’s what you’d be expected to do to set up the same dotfiles management system on another machine:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># set to different values as desired</span>
<span class="nv">DOTFILES</span><span class="o">=</span>dotfiles
<span class="nv">REMOTE</span><span class="o">=</span>git@github.com:username/dotfiles.git

<span class="nb">alias</span> <span class="nv">config</span><span class="o">=</span><span class="s1">'/usr/bin/git --git-dir=$HOME/$DOTFILES/ --work-tree=$HOME'</span>
<span class="nb">echo</span> <span class="s2">"</span><span class="nv">$DOTFILES</span><span class="s2">"</span> &gt;&gt; <span class="nv">$HOME</span>/.gitignore
git clone --bare <span class="nv">$REMOTE</span> <span class="nv">$HOME</span>/<span class="nv">$DOTFILES</span>
config checkout
</code></pre></div>
<p>At this point, you might see an error message if you have existing configuration files on your machine in locations that are already tracked by Git in your dotfiles on the remote repository. If that’s the case, you can move them to a secure place like so:</p>
<div class="highlight"><pre><span></span><code>mkdir -p .config-backup <span class="o">&amp;&amp;</span> <span class="se">\</span>
config checkout <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">|</span> egrep <span class="s2">"\s+\."</span> <span class="p">|</span> awk <span class="o">{</span><span class="s1">'print $1'</span><span class="o">}</span> <span class="p">|</span> <span class="se">\</span>
xargs -I<span class="o">{}</span> mv <span class="o">{}</span> .config-backup/<span class="o">{}</span>
</code></pre></div>
<p>Let’s make sure we don’t show all untracked files again:</p>
<div class="highlight"><pre><span></span><code>config config --local status.showUntrackedFiles no
</code></pre></div>
<p>From here, this will be the same workflow as described in the section <a href="#21-on-your-current-machine">2.1 On your current machine</a>.</p>
<hr/>
<h1 id="conclusion">Conclusion</h1>
<p>No more symlinks: this is definitely a nicer approach! You will need to be a bit more familiar with Git if you need to edit your Git history such as with the <code>rebase</code> sub-command or when adding changes selectively such as with the sub-command <code>add -p</code> to add files interactively — which might be the case if you want to commit only part of the changes made to one file — but that’s a great tool to master anyways, and there’s an article to get the ball rolling: <a href="https://www.sglavoie.com/posts/2022/04/03/git-the-gist-of-it-common-commands-for-a-working-workflow/">Git the gist of it: common commands for a working workflow</a> ;).</p>
<h2 id="more-resources-and-references">More resources and references</h2>
<ul>
<li><a href="https://www.youtube.com/watch?v=tBoLDpTWVOM">Git Bare Repository - A Better Way To Manage Dotfiles</a> — DistroTube, YouTube</li>
<li><a href="https://www.atlassian.com/git/tutorials/dotfiles">The best way to store your dotfiles: A bare Git repository</a>, the source of the idea for this post. — Atlassian</li>
</ul>
  </div>

  <div id="article_comments">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      var disqus_identifier = "posts/2021/05/30/managing-dotfiles-with-git-bare-repository/";
      (function () {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//sglavoie.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
  </div>

</article>
  
            <div id="ending_message">
                <p>
                    &copy; Sébastien Lavoie. Built with
                    <a
                        href="https://www.python.org/"
                        target="_blank"
                        rel="noopener noreferrer"
                        >Python</a
                    >
                    using
                    <a
                        href="http://getpelican.com"
                        target="_blank"
                        rel="noopener noreferrer"
                        >Pelican</a
                    >
                    <span class="badge">v4.8.0</span>. Theme adapted from Giulio Fidente on
                    <a
                        href="https://github.com/gfidente/pelican-svbhack"
                        target="_blank"
                        rel="noopener noreferrer"
                        >GitHub</a
                    >.
                    <a href="https://www.sglavoie.com/feeds/sglavoie.rss.xml">RSS feed</a>.
                </p>
            </div>
        </main>
    </body>
</html>