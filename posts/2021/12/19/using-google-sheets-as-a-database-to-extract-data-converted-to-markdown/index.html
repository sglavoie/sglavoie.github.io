<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="stylesheet" type="text/css" href="../../../../../theme/css/style.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../theme/css/pygments.css" />

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="Sébastien Lavoie" />
    <meta name="description"
        content="Posts and writings by Sébastien Lavoie. Customization setups and articles on productivity for developers who like minimalism." />
    <meta name="title" property="og:title" content="sglavoie.com" />
    <meta property="og:type" content="Website" />
    <meta name="image" property="og:image" content="../../../../../theme/images/logo_1200x627.png" />

     <link href="https://www.sglavoie.com/feeds/sglavoie.rss.xml" type="application/rss+xml" rel="alternate"
        title="sglavoie.com RSS" />

    <!-- Favicon -->
    <link rel="apple-touch-icon" href="/theme/favicon/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/theme/favicon/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/theme/favicon/favicon-16x16.png" />
    <link rel="manifest" href="/theme/favicon/site.webmanifest" />
    <link rel="mask-icon" href="/theme/favicon/safari-pinned-tab.svg" color="#5bbad5" />
    <link rel="shortcut icon" href="/theme/favicon/favicon.ico" />
    <meta name="msapplication-TileColor" content="#2d89ef" />
    <meta name="msapplication-TileImage" content="/theme/favicon/mstile-144x144.png" />
    <meta name="msapplication-config" content="/theme/favicon/browserconfig.xml" />
    <meta name="theme-color" content="#000000" />
    <meta name="msapplication-config" content="/theme/favicon/browserconfig.xml" />
    <meta name="theme-color" content="#000000" />

<meta name="keywords" content="google sheets, markdown, python, terminal">

<!-- Open graph for social networks -->
<meta name="og:title" property="og:title" content="Using Google Sheets API, this little tool reads a spreadsheet, extract relevant data and converts it into Markdown so it can be repurposed, in the example given to generate an HTML output for this website with Pelican, a powerful static site generator.">

    <title>sglavoie.com &ndash; Using Google Sheets as a database to extract data converted to&nbsp;Markdown</title>

    <!-- Enable tracking of web traffic -->
<script type="text/javascript">
    var _gaq = _gaq || []
    _gaq.push(['_setAccount', 'UA-150998392-1'])
    _gaq.push(['_trackPageview'])
    ;(function () {
        var ga = document.createElement('script')
        ga.type = 'text/javascript'
        ga.async = true
        ga.src =
            ('https:' == document.location.protocol
                ? 'https://ssl'
                : 'http://www') + '.google-analytics.com/ga.js'
        var s = document.getElementsByTagName('script')[0]
        s.parentNode.insertBefore(ga, s)
    })()
</script>
 </head>

<body>
    <aside>
        <div id="user_meta">
            <a href="../../../../..">
                <div>
                    <svg width="24.348mm" height="24.348mm" version="1.1" viewBox="0 0 24.348095 24.347754"
                        xmlns="http://www.w3.org/2000/svg" xmlns:cc="http://creativecommons.org/ns#"
                        xmlns:dc="http://purl.org/dc/elements/1.1/"
                        xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
                        <metadata>
                            <rdf:RDF>
                                <cc:Work rdf:about="">
                                    <dc:format>image/svg+xml</dc:format>
                                    <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
                                    <dc:title />
                                </cc:Work>
                            </rdf:RDF>
                        </metadata>
                        <g transform="translate(81.397 -84.454)">
                            <path d="m-57.049 105.9v2.9029h-11.173v-2.9029z" fill="#c0c0c0">
                                <animate attributeName="fill" values="white;grey;white" dur="2s"
                                    repeatCount="indefinite" />
                            </path>
                            <path
                                d="m-72.272 98.481-9.1246 5.7598v-3.548l5.8658-3.5019v-0.09215l-5.8658-3.5019v-3.548l9.1246 5.7598z"
                                fill="#c0c0c0" />
                            <path transform="scale(.26458)"
                                d="m-273.15 319.2-27.588 14.77 8.498 5.3613 19.09-12.049zm15.309 25.67v44.412h8.8672v-35.635h33.361v-8.7773h-33.783zm25.336 24.66v8.7774h8.0254v10.975h8.8672v-19.752z"
                                fill="#007bff" />
                        </g>
                    </svg>
                </div>
            </a>
            <ul>
                  <li><a href="../../../../../category/automation.html">automation</a></li>
                <li><a href="../../../../../category/learnings.html">learnings</a></li>
                <li><a href="../../../../../category/tips-and-tricks.html">tips-and-tricks</a></li>
                <li><a href="../../../../../category/tools.html">tools</a></li>
                <li><a href="../../../../../category/workflow.html">workflow</a></li>
              </ul>
        </div>
    </aside>

    <main>
        <header>
            <p>
                <a href="../../../../..">Home</a> &brvbar;
                <a href="../../../../../archives.html">Archives</a> &brvbar;
                <a href="../../../../../tags.html">Tags</a> &brvbar;
                <a href="../../../../../contact.html">Contact</a> &brvbar;
                <a href="https://drive.google.com/file/d/1t6GdZjC13naJXVGe6RinGowZLfkRzjy_/view" target="_blank"
                    rel="noopener noreferrer">Resume</a>
            </p>
        </header>

<article>
  <div class="article_title">
    <h1><a href="../../../../../posts/2021/12/19/using-google-sheets-as-a-database-to-extract-data-converted-to-markdown/">Using Google Sheets as a database to extract data converted to&nbsp;Markdown</a></h1>
  </div>
  <div class="flex-container">
    <div class="article_meta">
      <div>Posted on: Sun 19 December 2021</div>
      <div>
        <time class="modified" datetime="2021-12-26T13:31:00-06:00">
          Modified on: Sun 26 December 2021
        </time>
      </div>
      <div>Category: <a href="../../../../../category/automation.html">automation</a>
 &ndash; Tags:
        <a href="../../../../../tag/google-sheets.html">google sheets</a>,        <a href="../../../../../tag/markdown.html">markdown</a>,        <a href="../../../../../tag/python.html">python</a>,        <a href="../../../../../tag/terminal.html">terminal</a>      </div>
    </div>
    <div class="article_readtime">
      Estimated read time: 6 minutes
    </div>
  </div>

  <h2 class="toc-title">Table of contents</h2>
  </div>
  <nav class="toc">
    <div class="toc">
<ul>
<li><a href="#introduction">Introduction</a><ul>
<li><a href="#general-software-requirements">General software requirements</a><ul>
<li><a href="#input">Input</a></li>
<li><a href="#output">Output</a></li>
</ul>
</li>
<li><a href="#installing-this-tool">Installing this tool</a><ul>
<li><a href="#using-pip">Using pip</a></li>
<li><a href="#using-pipenv">Using pipenv</a></li>
</ul>
</li>
<li><a href="#how-to-use-this-tool">How to use this tool</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
</div>
  </nav>
  <div class="article_text">
    
<hr/>
<h1 id="introduction">Introduction</h1>
<p>The purpose of this tool is to parse and convert the content of a Google Sheets spreadsheet to Markdown. In this specific case, I just wanted a simple script to reduce the friction in getting a valid output I could use to maintain a <a href="../../../../../posts/2022/06/18/what-it-took-to-propel-a-career-in-tech-in-five-years/">“learning log” on my website</a>. So that gives me a quick way to input data in a spreadsheet and then I can take the time whenever needed to update the learning progress as desired by reformatting any of the entries and optionally adding notes to them.</p>
<hr/>
<h2 id="general-software-requirements">General software requirements</h2>
<p>This tool should:</p>
<ul>
<li>Be able to read a private spreadsheet with a service account configured with the Google Sheets <span class="caps">API</span>.</li>
<li>Convert rows from a Google Sheets spreadsheet into Markdown (see <strong>Input</strong> and <strong>Output</strong> sections below for details).</li>
<li>Skip rendering rows that are missing a value for the <code>Title</code> or <code>Date</code> columns (it couldn’t be rendered in the correct place properly without this information).</li>
<li>Other columns are optional and the corresponding level of nesting will be skipped if no value was provided (e.g. a category <code>Articles</code> may have an item with no sub-category and could be missing any of the other values except for <code>Title</code> and <code>Date</code>).</li>
<li>Separate entries by month by parsing the <code>Date</code> column.</li>
<li>A command-line parameter should exist to specify a year from which the date should be extracted.</li>
<li>The output should be in reverse chronological order (i.e. for a full year with entries for each month, December will appear at the top and January at the bottom).</li>
<li>Output a hierarchical format like the following: <code>Category &gt; Sub-category &gt; Title &gt; Activity &amp; notes</code></li>
<li>Group entries by category <strong>and</strong> sub-category (e.g. if a category is named <code>Articles</code> and there is a sub-category named <code>Python</code>, then <code>Python</code> must be nested under <code>Articles</code> for the corresponding month).</li>
<li>Sort on the <code>Date</code> column before doing any parsing on other columns (rows in the spreadsheet <em>can</em> be in non-chronological order).</li>
<li>Dates from a single year will be kept (either the year received as a parameter or the most recent year found).</li>
<li>Sort <code>Category</code>, <code>Sub-category</code> and <code>Title</code> alphabetically (ascending order from top to bottom).</li>
<li><strong>Not</strong> sort the <code>Activity</code> column to preserve the order in which rows were added to the spreadsheet.</li>
<li>Render links only if the <code>Link</code> column is a valid <span class="caps">URL</span>.</li>
<li><strong>Not</strong> validate the content of columns except for <code>Date</code> and <code>Link</code> (i.e. render the other columns as is).</li>
<li>Display items with no category above those having a category. The same logic would be true for sub-categories.</li>
<li>Format the output:</li>
<li><code>Date</code> should become headers (<code>##</code>).</li>
<li><code>Category</code> should be <strong>bolded</strong>.</li>
<li><code>Sub-category</code> should be <em>emphasized</em>.</li>
<li><code>Title</code> should become a <a href="https://example.com">link</a> if the <code>Link</code> column contains a valid <span class="caps">URL</span>.</li>
<li><code>Activity</code> should be nested under <code>Title</code>, occupying a new line for each activity.</li>
<li><code>Notes</code> should appear (<em>italicized and inside parentheses</em>) next to the activity.<ul>
<li>If there is a value for <code>Notes</code> but no value for <code>Activity</code>, the output would be next to the <code>Title</code>.</li>
</ul>
</li>
</ul>
<h3 id="input">Input</h3>
<p>A spreadsheet with the following columns (starting with <strong>Date</strong>):</p>
<div style="overflow-x: auto"><table>
<thead>
<tr>
<th>[additional info]</th>
<th>Date</th>
<th>Category</th>
<th>Sub-category</th>
<th>Title</th>
<th>Activity</th>
<th>Link</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>November</td>
<td>13/11/2021</td>
<td>Articles</td>
<td>Python</td>
<td>Python slots, slots, and object layout</td>
<td></td>
<td>https://www.youtube.com/watch?v=Iwf17zsDAnY</td>
<td>understood that X does Y</td>
</tr>
<tr>
<td>November</td>
<td>14/11/2021</td>
<td>Books</td>
<td>Software engineering</td>
<td>The Pragmatic Programmer</td>
<td>ch. 1</td>
<td>https://pragprog.com/titles/tpp20/the-pragmatic-programmer-20th-anniversary-edition/</td>
<td>note 1 here</td>
</tr>
<tr>
<td>November</td>
<td>15/11/2021</td>
<td>Books</td>
<td>Software engineering</td>
<td>The Pragmatic Programmer</td>
<td>ch. 2</td>
<td></td>
<td>note 2 here too</td>
</tr>
<tr>
<td>November</td>
<td>16/11/2021</td>
<td>Books</td>
<td>Software engineering</td>
<td>Clean Code</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>December</td>
<td>1/12/2021</td>
<td>Documentation</td>
<td>Python</td>
<td>The Python Tutorial</td>
<td>Sections 1-4</td>
<td>https://docs.python.org/3/tutorial/index.html</td>
<td></td>
</tr>
<tr>
<td>December</td>
<td>2/12/2021</td>
<td>Books</td>
<td>Software engineering</td>
<td>Clean Code</td>
<td>ch. 2-10</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Render available values</td>
<td>2/12/2021</td>
<td>Books</td>
<td></td>
<td>Clean Coder</td>
<td></td>
<td></td>
<td>book note</td>
</tr>
<tr>
<td>Render available values</td>
<td>2/12/2021</td>
<td></td>
<td></td>
<td>Python/C <span class="caps">API</span> Reference Manual</td>
<td></td>
<td>https://docs.python.org/3/c-api/index.html</td>
<td></td>
</tr>
<tr>
<td>Title missing: skip rendering</td>
<td>3/12/2021</td>
<td>Articles</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Title missing: skip rendering</td>
<td>3/12/2021</td>
<td>Articles</td>
<td>Software engineering</td>
<td></td>
<td>ch. 3</td>
<td>https://docs.python.org/3/c-api/index.html</td>
<td>note</td>
</tr>
<tr>
<td>Date missing: skip rendering</td>
<td></td>
<td>Articles</td>
<td>Python</td>
<td>Python slots, slots, and object layout</td>
<td>Section 2</td>
<td>https://www.youtube.com/watch?v=Iwf17zsDAnY</td>
<td>note not rendered</td>
</tr>
</tbody>
</table></div>
<h3 id="output">Output</h3>
<p>A Markdown output to the terminal in the following format:</p>
<div class="highlight"><pre><span></span><code><span class="gu">## December</span>

<span class="k">-</span> [<span class="nt">Python/C API Reference Manual</span>](<span class="na">https://docs.python.org/3/c-api/index.html</span>)
<span class="k">-</span> <span class="gs">**Books**</span>
    <span class="k">-</span> Clean Coder (<span class="ge">_book note_</span>)
    <span class="k">-</span> <span class="ge">*Software engineering*</span>
        <span class="k">-</span> Clean Code
            <span class="k">-</span> ch. 2-10
<span class="k">-</span> <span class="gs">**Documentation**</span>
    <span class="k">-</span> <span class="ge">*Python*</span>
        <span class="k">-</span> [<span class="nt">The Python Tutorial</span>](<span class="na">https://docs.python.org/3/tutorial/index.html</span>)
            <span class="k">-</span> Sections 1-4

<span class="gu">## November</span>

<span class="k">-</span> <span class="gs">**Articles**</span>
    <span class="k">-</span> <span class="ge">*Python*</span>
        <span class="k">-</span> [<span class="nt">Python slots, slots, and object layout</span>](<span class="na">https://www.youtube.com/watch?v=Iwf17zsDAnY</span>) (<span class="ge">_understood that X does Y_</span>)
<span class="k">-</span> <span class="gs">**Books**</span>
    <span class="k">-</span> <span class="ge">*Software engineering*</span>
        <span class="k">-</span> Clean Code
        <span class="k">-</span> [<span class="nt">The Pragmatic Programmer</span>](<span class="na">https://pragprog.com/titles/tpp20/the-pragmatic-programmer-20th-anniversary-edition/</span>)
            <span class="k">-</span> ch. 1 (<span class="ge">_note 1 here_</span>)
            <span class="k">-</span> ch. 2 (<span class="ge">_note 2 here too_</span>)
</code></pre></div>
<figure>
<a href="../../../../../images/posts/0028_google_sheets_as_database_output_markdown/input_output.png"><img alt="input_output_example" class="max-size-img-post" src="../../../../../images/posts/0028_google_sheets_as_database_output_markdown/input_output.png"/></a>
<figcaption>Input/Output example when using this tool.</figcaption>
</figure>
<h2 id="installing-this-tool">Installing this tool</h2>
<p><em>Tested only under Python 3.9.7</em>, requires at least Python 3.7+.</p>
<h3 id="using-pip">Using <code>pip</code></h3>
<ul>
<li>[recommended] Activate a virtual environment.</li>
<li>To install dependencies, run from this directory: <code>pip install -r requirements.txt</code></li>
<li>Then execute the script to run the tool: <code>python3 get_learning_logs</code></li>
</ul>
<h3 id="using-pipenv">Using <code>pipenv</code></h3>
<ul>
<li>Run from this directory: <code>pipenv install</code>.</li>
<li>Activate the newly created virtual environment with <code>pipenv shell</code>.</li>
<li>Then execute the script to run the tool: <code>python3 get_learning_logs</code></li>
</ul>
<h2 id="how-to-use-this-tool">How to use this tool</h2>
<p>You will need to create an environment file (default path: <code>~/.learning-logs</code> or edit the path for <code>LEARNING_LOGS_ENV_PATH</code> in <code>get_learning_logs.py</code>). It should look as follows:</p>
<div class="highlight"><pre><span></span><code><span class="n">SERVICE_ACCOUNT_FILEPATH</span><span class="o">=</span><span class="s2">"/path/to/service_account_learning_logs.json"</span><span class="w"></span>
<span class="n">SPREADSHEET_ID</span><span class="o">=</span><span class="n">SPREADSHEET_ID</span><span class="w">  </span><span class="c1"># Found in the URL of the document</span><span class="w"></span>
<span class="n">WORKSHEET_ID</span><span class="o">=</span><span class="mi">0</span><span class="w">  </span><span class="c1"># First sheet is 0 by default, it comes after the URL parameter `gid`</span><span class="w"></span>
</code></pre></div>
<p>To set up this project, you will have to:</p>
<ul>
<li>Enable the Google Sheets <span class="caps">API</span> for your project (https://support.google.com/googleapi/answer/6158841?hl=en).</li>
<li>In the project, search for “service account” in the search bar and create new credentials.</li>
<li>Download the credentials and put them at the path <code>SERVICE_ACCOUNT_FILEPATH</code> referenced in the environment file.</li>
<li>Create a spreadsheet with the following columns (not necessarily in that order): <code>Date</code>, <code>Category</code>, <code>Sub-category</code>, <code>Title</code>, <code>Activity</code>, <code>Link</code>, <code>Notes</code>.</li>
<li>The column <code>Date</code> Should match a date format: select all cells from that column, go to <code>Format &gt; Number &gt; Date</code> to apply the expected format (<code>mm/dd/yyyy</code>). You can then input a date (e.g. <code>11/1/2021</code>) and you will see a calendar pop up when double-clicking on it. Dragging it down to a new cell will create a new date for the next day (in this example, <code>11/2/2021</code>).</li>
<li>Get its <code>SPREADSHEET_ID</code> (<code>https://docs.google.com/spreadsheets/d/SPREADSHEET_ID_HERE/edit#gid=0</code>) to put it in the environment file.</li>
<li>Get the <code>WORKSHEET_ID</code> (the integer after <code>gid=</code> in the <span class="caps">URL</span> of the document).</li>
<li>From the spreadsheet document (or from the folder view in Google Drive), share with the email associated with the service account (e.g. <code>learning-logs-something@project-name-12345.iam.gserviceaccount.com</code>). Read access (“Viewer” permission) is enough.</li>
</ul>
<p>By now, the script is ready to be called. I just created an alias to execute it more easily by putting the following in <code>~/.bash_aliases</code> (you will have to adapt the paths of course):</p>
<div class="highlight"><pre><span></span><code><span class="nb">alias</span> learning-logs<span class="o">=</span><span class="s1">'~/.local/share/virtualenvs/learning-logs-to-markdown-XJLvhmzn/bin/python3.9 \</span>
<span class="s1">  ~/dev/sglavoie/dev-helpers/learning-logs-to-markdown/get_learning_logs.py'</span>
</code></pre></div>
<p>This will output the converted data from the spreadsheet to Markdown <a href="#output">as shown above</a>.</p>
<hr/>
<h1 id="conclusion">Conclusion</h1>
<p>This little tool scratched an itch and will be helpful in making the process of updating the <a href="../../../../../posts/2022/06/18/what-it-took-to-propel-a-career-in-tech-in-five-years/">learning progress</a> of this website more straightforward, more convenient and less hands-on! You can find its source code <a href="https://github.com/sglavoie/dev-helpers/tree/main/learning-logs-to-markdown">on GitHub</a>.</p>
  </div>

  <div id="article_comments">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      var disqus_identifier = "posts/2021/12/19/using-google-sheets-as-a-database-to-extract-data-converted-to-markdown/";
      (function () {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//sglavoie.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
  </div>

</article>
  
        <div id="ending_message">
            <p>
                &copy; Sébastien Lavoie. Built with
                <a href="https://www.python.org/" target="_blank" rel="noopener noreferrer">Python</a>
                using
                <a href="http://getpelican.com" target="_blank" rel="noopener noreferrer">Pelican</a>
                <span class="badge">v4.8.0</span>. Theme adapted from Giulio Fidente on
                <a href="https://github.com/gfidente/pelican-svbhack" target="_blank"
                    rel="noopener noreferrer">GitHub</a>.
                <a href="https://www.sglavoie.com/feeds/sglavoie.rss.xml">RSS feed</a>.
            </p>
        </div>
    </main>
</body>

</html>