<!DOCTYPE html>
<html lang="en">
    <head>
          <title>Executing Shell Commands in a Python&nbsp;Script | sglavoie.com</title>

<link href="https://www.sglavoie.com/feeds/sglavoie.rss.xml" type="application/rss+xml" rel="alternate" title="sglavoie.com Full RSS Feed" />

        <!-- Favicon -->
        <link rel="apple-touch-icon" sizes="180x180" href="/theme/images/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/theme/images/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/theme/images/favicon-16x16.png">
        <link rel="manifest" href="/theme/images/site.webmanifest">
        <link rel="mask-icon" href="/theme/images/safari-pinned-tab.svg" color="#5bbad5">
        <link rel="shortcut icon" href="/theme/images/favicon.ico">
        <meta name="msapplication-TileColor" content="#2d89ef">
        <meta name="msapplication-TileImage" content="/theme/images/mstile-144x144.png">
        <meta name="msapplication-config" content="/theme/images/browserconfig.xml">
        <meta name="theme-color" content="#000000">
        <meta name="msapplication-config" content="/theme/images/browserconfig.xml">
        <meta name="theme-color" content="#000000">

        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta name="description" content="I document my journey as a learner in technology-related matters, explaining the challenges that I face while trying to become a better student. I teach the solutions that I find along the way so that it can benefit others too.">

        <!-- Bootstrap CSS -->
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

        <!-- Font Awesome Icons -->
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">

        <!-- Custom CSS -->
        <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
        <link href='/theme/css/base.css?cache_id=303a4a85dfdcc9384a7357f12911d26f' rel='stylesheet' type='text/css'>
        <link href='/theme/css/pygment.css?cache_id=503914e4e79f274778eabccca9bcd1f9' rel='stylesheet' type='text/css'>



<!-- Open graph for social networks -->
    <meta name="og:title" property="og:title" content="Even for simple tasks, it is often worth basing one's work on existing solutions when it is an appropriate option... And such can be the case when writing Python scripts!">

    <meta name="tags" content="python" />
    <meta name="tags" content="script" />

    </head>

    <body id="index" class="home">

        <nav id="bg-darker" class="navbar navbar-expand-lg navbar-dark">
            <a class="brand-link" href="/">

                <!-- SVG Logo with 5px padding -->
                <div class="brand-logo hover-img">
                    <svg width="24.348mm" height="24.348mm" version="1.1" viewBox="0 0 24.348095 24.347754" xmlns="http://www.w3.org/2000/svg" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
                        <metadata>
                        <rdf:RDF>
                        <cc:Work rdf:about="">
                        <dc:format>image/svg+xml</dc:format>
                        <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/>
                        <dc:title/>
                        </cc:Work>
                        </rdf:RDF>
                        </metadata>
                        <g transform="translate(81.397 -84.454)">
                        <path d="m-57.049 105.9v2.9029h-11.173v-2.9029z" fill="#c0c0c0">
                        <animate attributeName="fill" values="white;grey;white" dur="2s" repeatCount="indefinite" />
                        </path>
                        <path d="m-72.272 98.481-9.1246 5.7598v-3.548l5.8658-3.5019v-0.09215l-5.8658-3.5019v-3.548l9.1246 5.7598z" fill="#c0c0c0"/>
                        <path transform="scale(.26458)" d="m-273.15 319.2-27.588 14.77 8.498 5.3613 19.09-12.049zm15.309 25.67v44.412h8.8672v-35.635h33.361v-8.7773h-33.783zm25.336 24.66v8.7774h8.0254v10.975h8.8672v-19.752z" fill="#007bff"/>
                        </g>
                    </svg>
                </div>


            </a>
            <button class="navbar-toggler hover-img" type="button" data-toggle="collapse" data-target="#sglavoie-menu" aria-controls="sglavoie-menu" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
                Main Menu
            </button>

            <div class="collapse navbar-collapse" id="sglavoie-menu">
                <div class="to-the-right">
                    <ul class="navbar-nav mr-auto mt-2 mt-lg-0">

                        <li class="nav-item">
                            <a class="nav-link" href="/index.html"><i class="fas fa-home"></i> home</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/tags.html"><i class="fas fa-hashtag"></i> tags</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/learning-progress-2019.html"><i class="fas fa-graduation-cap"></i> learning</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/about.html"><i class="fas fa-info"></i> about</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>

        <nav id="menu" class="navbar navbar-expand-lg navbar-dark">

            <button class="navbar-toggler hover-img" type="button" data-toggle="collapse" data-target="#sglavoie-menu-second" aria-controls="sglavoie-menu-second" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
                Categories
            </button>

            <div class="collapse navbar-collapse" id="sglavoie-menu-second">
                <div id="menu-categories-legend-id" class="menu-categories-legend">
                    <a href="/categories.html"><img class="img-categories" src="/theme/images/categories.svg" alt="Categories"></a>
                </div>
                <ul class="navbar-nav mr-auto mt-2 mt-lg-0">



                    <li class="nav-item">
                        <a class="lowercase-title always-white nav-link-smaller" href="https://www.sglavoie.com/category/automation.html">automation</a>
                    </li>

                    <li class="nav-item">
                        <a class="lowercase-title always-white nav-link-smaller" href="https://www.sglavoie.com/category/tips-and-tricks.html">tips-and-tricks</a>
                    </li>

                    <li class="nav-item">
                        <a class="lowercase-title always-white nav-link-smaller" href="https://www.sglavoie.com/category/tools.html">tools</a>
                    </li>

                    <li class="nav-item">
                        <a class="lowercase-title always-white nav-link-smaller" href="https://www.sglavoie.com/category/workflow.html">workflow</a>
                    </li>

                </ul>
            </div>
        </nav>
        <!-- /#menu -->


    <section id="content" class="jumbotron body">
        <header>
            <h2 class="display-4">
                <a href="https://www.sglavoie.com/posts/2019/03/08/executing-shell-commands-in-a-python-script/" rel="bookmark"
                    title="Permalink to Executing Shell Commands in a Python Script">Executing Shell Commands in a Python&nbsp;Script</a></h2>
            
        </header>
        <footer class="post-info">
            <i class="fas fa-calendar-alt"></i> <time class="published" datetime="2019-03-08T14:34:00-06:00">
                March 08, 2019
            </time>
            <address class="vcard author">
            </address>
            <div class="category">
                <i class="fas fa-tag"></i> Category: <a class="emphasis post-info-space" href="https://www.sglavoie.com/category/tips-and-tricks.html">tips-and-tricks</a>
            </div>
            <div class="tags">
                <i class="fas fa-hashtag"></i> Tags:
                <a class="emphasis post-info-space" href="https://www.sglavoie.com/tag/python.html">python</a>
                <a class="emphasis post-info-space" href="https://www.sglavoie.com/tag/script.html">script</a>
            </div>
        </footer><!-- /.post-info -->
  <hr class="my-4">
  <div class="card">
      <div class="card-body entry-content">
          <p>Python is awesome for producing high-quality code quickly
and efficiently, but it is not necessary to reinvent the
wheel in each project: this is why the third-party library on
<a href="https://pypi.org/">PyPI</a> is so extensive. There are also occasions when
it is convenient to execute shell commands available in the terminal,
either to retrieve its output or to perform some work in the background.
I have wanted to do both when building this website, so here is one way
to accomplish&nbsp;this!</p>
<h3>Retrieve the&nbsp;output</h3>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">read_tree</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;Execute `tree` command and store the output in</span>
<span class="sd">    `tree.txt`.&#39;&#39;&#39;</span>
    <span class="n">tree</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">getoutput</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;tree .&#39;</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;./tree.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>


<span class="n">read_tree</span><span class="p">()</span>
</pre></div>


<p>In this example, the structure from the current directory is printed
when executing the code and it is later stored in a file. The output
could look something like the&nbsp;following:</p>
<div class="highlight"><pre><span></span>.
├── database_example
│   ├── example.sqlite
│   ├── db_manager.py
│   ├── review
│   │   └── sql_queries.txt
│   └── settings.py
├── database_sql.py
├── dump.sql
├── example.db
├── example.db.sql
├── example_info.txt
├── example_old.db
├── example_old.db.sql
├── sample
│   ├── chinook.db
│   └── sqlite-sample-database-diagram-color.pdf
├── test.db
└── test.sql

3 directories, 15 files
</pre></div>


<h3>Execute a command in the&nbsp;background</h3>
<p>There are also instances in which is it useful to execute a program
from the terminal inside a Python script. This website, for example,
currently exports daily Git statistics in the <code>output/</code> folder. This
looks like&nbsp;this:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">daily_stats</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;Execute `Gitstats` once a day based on the date found in</span>
<span class="sd">    `stats_counter.txt`. Very simple with a caveat: it won&#39;t check if</span>
<span class="sd">    there are new commits on the same day if stats have already been</span>
<span class="sd">    generated on that day.&#39;&#39;&#39;</span>
    <span class="n">today</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;stats_counter.txt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">content</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">content</span> <span class="o">!=</span> <span class="n">today</span><span class="p">:</span>
        <span class="n">current_loc</span> <span class="o">=</span> <span class="n">current_path</span><span class="p">()</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;gitstats&quot;</span><span class="p">,</span> <span class="s2">&quot;-c&quot;</span><span class="p">,</span> <span class="s2">&quot;project_name=&#39;sglavoie.com&#39;&quot;</span><span class="p">,</span>
               <span class="n">f</span><span class="s2">&quot;{current_loc}&quot;</span><span class="p">,</span> <span class="n">f</span><span class="s2">&quot;{current_loc}/output/stats/&quot;</span><span class="p">]</span>
        <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;stats_counter.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">today</span><span class="p">)</span>
</pre></div>


<p>This is an automated process, which is something Python is easy to use
for. However, it won&#8217;t be necessary to program everything: it all gets
generated on&nbsp;demand!</p>
<h2>Conclusion</h2>
<p>I am always amazed at how easy it can be to automate simple tasks like
those mentioned above. Programming can be very rewarding regardless of
initial abilities. Just beyond the most basic stuff, suddenly there is a
world that opens up to those that stay curious long enough <i class="fas
fa-smile"></i>.</p>
      </div>
  </div>
        <!-- /.entry-content -->

	<hr>

	<h2 class="display-4"><i class="fas fa-comment-alt"></i> Comments</h2>
<div id="disqus_thread"></div>
<script type="text/javascript">
    // Substitute single quotation mark (') for double (") to allow
    // article's title to contain single quotes.
    var disqus_shortname = "sglavoie"; 
    var disqus_title = "Executing Shell Commands in a Python&nbsp;Script";

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


    </section>

        <div class="footer-borders">
            <footer id="contentinfo" class="body bg-border hover-footer-bg">

                <address class="footer-icons">

                    <div class="get-in-touch-icons">
                        <ul class="social-footer">

                            <li><a href="https://github.com/sglavoie"><img src="/theme/images/footer/github.svg" alt="GitHub"></a></li>
                            <li><a href="https://www.twitter.com/sgdlavoie"><img src="/theme/images/footer/twitter.svg" alt="Twitter"></a></li>
                            <li><a href="https://www.linkedin.com/in/sglavoie"><img src="/theme/images/footer/linkedin.svg" alt="LinkedIn"></a></li>
                            <li><a href="https://www.hackerrank.com/sglavoie"><img src="/theme/images/footer/hackerrank.svg" alt="HackerRank"></a></li>
                            <li><a href="https://stackoverflow.com/users/story/8787680"><img src="/theme/images/footer/stackoverflow.svg" alt="Stackoverflow"></a></li>

                    </div>

                </address>

                <address id="about" class="vcard body">
                    Proudly powered by <a href="http://getpelican.com/">Pelican 4.0.1<img class="mini-icon" src="/theme/images/footer/pelican.svg" alt="Pelican"></a>,
                    which takes great advantage of <a href="http://python.org">Python<img class="mini-icon" src="/theme/images/footer/python.svg" alt="Python"></a> .

                    <div id="author-footer">
                        <p>Copyleft <span class="copy-left">©</span> 2019 — Sébastien Lavoie
                        <script type="text/javascript" language="javascript">
                            <!--
// Email obfuscator script 2.1 by Tim Williams, University of Arizona
// Random encryption key feature coded by Andrew Moulden
// This code is freeware provided these four comment lines remain intact
// A wizard to generate this code is at http://www.jottings.com/obfuscator/
{ coded = "Efp9ExWfz@EoU9R5Wf.45D"
    key = "RXmOLk0xFelpj9ihYV4PZ5AGDB3wsKdfUn12WHJgvqNIrCytS8EbQa6zuMc7To"
    shift=coded.length
    link=""
    for (i=0; i<coded.length; i++) {
        if (key.indexOf(coded.charAt(i))==-1) {
            ltr = coded.charAt(i)
            link += (ltr)
        }
        else {
            ltr = (key.indexOf(coded.charAt(i))-shift+key.length) % key.length
            link += (key.charAt(ltr))
        }
    }
    // Adding inline style to 'img' tag as it seems to be more trustworthy inside this script.
    document.write("<a href='mailto:"+link+"'>"+"<img class='mini-icon' src='/theme/images/footer/email.svg' alt='Email'>"+"</a>")
}
//-->
                        </script><noscript>Sorry, you need Javascript on to email me.</noscript>
                        </p>
                    </div>
                </address>

                <div class="version-footer">v0.17.0</div>

                <!-- /#about -->
            </footer>

        </div>
        <!-- /#contentinfo -->

        <!-- Optional JavaScript -->
        <!-- jQuery first, then Popper.js, then Bootstrap JS -->
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

        <!-- Disqus comment counts for each article -->
        <script id="dsq-count-scr" src="https://sglavoie.disqus.com/count.js" async></script>
    </body>
</html>